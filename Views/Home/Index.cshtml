@{
    ViewData["Title"] = "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Sofia";
}

<!-- Onboarding Modal Trigger -->
@if (Context.Session.GetString("UserId") != null && Context.Session.GetString("OnboardingCompleted") != "true")
{
    <div class="onboarding-welcome mb-4">
        <div class="alert alert-info d-inline-flex align-items-center gap-3">
            <div>
                <strong>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</strong> –î–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º –≤–∞—à–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø–æ–ª—å–∑—ã.
                <button class="btn btn-primary btn-sm ms-3" onclick="startOnboarding()">–ù–∞—á–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É</button>
            </div>
        </div>
    </div>
}

<!-- Carousel removed per request -->

<div class="container">
    <!-- Features Overview -->
    <div class="row g-4 mb-5">
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üìù</div>
                <h4>–ó–∞–º–µ—Ç–∫–∏ –∏ —ç–º–æ—Ü–∏–∏</h4>
                <p>–í–µ–¥–∏—Ç–µ –¥–Ω–µ–≤–Ω–∏–∫ —ç–º–æ—Ü–∏–π, –∑–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ –º—ã—Å–ª–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.</p>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üìÖ</div>
                <h4>–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h4>
                <p>–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–≤–æ–∏ —ç–º–æ—Ü–∏–∏ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π.</p>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üìä</div>
                <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h4>
                <p>–ü–æ–ª—É—á–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —ç–º–æ—Ü–∏–π, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ —Ü–µ–ª—è–º.</p>
            </div>
        </div>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üéØ</div>
                <h4>–¶–µ–ª–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h4>
                <p>–°—Ç–∞–≤—å—Ç–µ —Ü–µ–ª–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –æ—Ç–º–µ—á–∞–π—Ç–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ñ–µ—Ä–∞—Ö –∂–∏–∑–Ω–∏.</p>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üßò</div>
                <h4>–ü—Ä–∞–∫—Ç–∏–∫–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏</h4>
                <p>–ò–∑—É—á–∞–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏, –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –∏ —Ä–∞–±–æ—Ç—ã —Å —ç–º–æ—Ü–∏—è–º–∏.</p>
            </div>
        </div>
        @if (Context.Session.GetString("UserRole") != "psychologist") {
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üêæ</div>
                <h4>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–º–ø–∞–Ω—å–æ–Ω</h4>
                <p>–û–±—â–∞–π—Ç–µ—Å—å —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º –ø–∏—Ç–æ–º—Ü–µ–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –≤–∞—à–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.</p>
            </div>
        </div>
        }
    </div>

    <div class="row g-4 mb-5">
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üë•</div>
                <h4>–ü—Å–∏—Ö–æ–ª–æ–≥–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã</h4>
                <p>–ù–∞–π–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞, –∑–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –ø–æ–º–æ—â—å.</p>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">üîî</div>
                <h4>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</h4>
                <p>–ü–æ–ª—É—á–∞–π—Ç–µ —É–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö, —Ü–µ–ª—è—Ö –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö –≤ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è.</p>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="feature-card">
                <div class="feature-icon">‚öôÔ∏è</div>
                <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—Ä–æ—Ñ–∏–ª—å</h4>
                <p>–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º.</p>
            </div>
        </div>
    </div>

    <!-- Tests Feature -->
    <div class="row g-4 mb-5">
        <div class="col-lg-4">
                    <div class="feature-card">
                        <div class="feature-icon">üß™</div>
                        <h4>–¢–µ—Å—Ç—ã –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏</h4>
                        <p>–ü—Ä–æ–π–¥–∏—Ç–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.</p>
                    </div>
        </div>
    </div>

    <!-- Quick Start Guide -->
    <div class="card mb-5">
        <div class="card-header">
            <h3 class="mb-0">üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h3>
        </div>
        <div class="card-body">
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="step-item">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h5>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–º–µ—Ç–∫—É</h5>
                            <p>–ó–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–∏ –º—ã—Å–ª–∏ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –≤—ã —Å–µ–π—á–∞—Å –∏—Å–ø—ã—Ç—ã–≤–∞–µ—Ç–µ.</p>
                            <a href="/notes/create" class="btn btn-primary btn-sm">–°–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-item">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h5>–ü–æ—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —Ü–µ–ª—å</h5>
                            <p>–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, —á–µ–≥–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ—Å—Ç–∏—á—å, –∏ –Ω–∞—á–Ω–∏—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.</p>
                            <a href="/goals/create" class="btn btn-primary btn-sm">–°–æ–∑–¥–∞—Ç—å —Ü–µ–ª—å</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-item">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h5>–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—å</h5>
                            <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —ç–º–æ—Ü–∏–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ.</p>
                            <a href="/calendar" class="btn btn-primary btn-sm">–û—Ç–∫—Ä—ã—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="step-item">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h5>–ò–∑—É—á–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h5>
                            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –∏ —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—è.</p>
                            <a href="/practices" class="btn btn-primary btn-sm">–í—ã–±—Ä–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tips and Benefits -->
    <div class="row g-4 mb-5">
        <div class="col-lg-6">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é</h5>
                </div>
                <div class="card-body">
                    <ul class="tips-list">
                        <li>üìù –ó–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ –∑–∞–º–µ—Ç–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç–º–æ—Ü–∏–π</li>
                        <li>üéØ –°—Ç–∞–≤—å—Ç–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ü–µ–ª–∏ –∏ –æ—Ç–º–µ—á–∞–π—Ç–µ –¥–∞–∂–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</li>
                        <li>üìä –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤</li>
                        <li>üßò –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –≤ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã</li>
                        <li>üë• –ù–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –ø—Å–∏—Ö–æ–ª–æ–≥–∞–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="mb-0">üåü –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Sofia</h5>
                </div>
                <div class="card-body">
                    <ul class="benefits-list">
                        <li>üîí –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</li>
                        <li>üì± –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–º –±—Ä–∞—É–∑–µ—Ä–µ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</li>
                        <li>üåô –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–µ—Ç–ª–æ–π –∏ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã</li>
                        <li>üìä –ü–æ–¥—Ä–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</li>
                        <li>üé® –ö—Ä–∞—Å–∏–≤—ã–π –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</li>
                        <li>üÜì –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</li>
                        <li>üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö</li>
                        <li>ü§ñ –£–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Call to Action -->
    <div class="text-center py-5">
        <h2 class="mb-4">–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å –ø—É—Ç—å –∫ –ª—É—á—à–µ–º—É —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—é?</h2>
        <p class="lead mb-4">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —Ç—ã—Å—è—á–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —É–ª—É—á—à–∏–ª–∏ —Å–≤–æ—é –∂–∏–∑–Ω—å —Å –ø–æ–º–æ—â—å—é Sofia</p>
        <div class="d-flex gap-3 justify-content-center">
            @if (Context.Session.GetString("UserId") != null) {
                <a href="/notes/create" class="btn btn-primary btn-lg">üìù –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –∑–∞–º–µ—Ç–∫—É</a>
                <a href="/goals/create" class="btn btn-outline-primary btn-lg">üéØ –ü–æ—Å—Ç–∞–≤–∏—Ç—å —Ü–µ–ª—å</a>
            } else {
                <a href="/auth/login" class="btn btn-primary btn-lg">–í–æ–π—Ç–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å</a>
            }
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // –ö–∞—Ä—É—Å–µ–ª—å —É–¥–∞–ª–µ–Ω–∞ ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞
        
        // Onboarding system
        let currentOnboardingStep = 0;
        const onboardingSteps = [
            {
                title: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Sofia! üåü",
                content: "–Ø - –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —ç–º–æ—Ü–∏–π –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π. –î–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º –≤—Å—ë –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã.",
                action: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å",
                highlight: null
            },
            {
                title: "–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–º–µ—Ç–∫—É üìù",
                content: "–ù–∞—á–Ω–∏—Ç–µ —Å –∑–∞–ø–∏—Å–∏ –≤–∞—à–∏—Ö —Ç–µ–∫—É—â–∏—Ö –º—ã—Å–ª–µ–π –∏ —ç–º–æ—Ü–∏–π. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞—Ç—å —Å–µ–±—è.",
                action: "–°–æ–∑–¥–∞—Ç—å –∑–∞–º–µ—Ç–∫—É",
                highlight: ".feature-card:has(.feature-icon:contains('üìù'))",
                actionUrl: "/notes/create"
            },
            {
                title: "–ü–æ—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —Ü–µ–ª—å üéØ",
                content: "–¶–µ–ª–∏ –ø–æ–º–æ–≥–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∂–∏–∑–Ω—å –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å. –ù–∞—á–Ω–∏—Ç–µ —Å —á–µ–≥–æ-—Ç–æ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –∏ –¥–æ—Å—Ç–∏–∂–∏–º–æ–≥–æ.",
                action: "–°–æ–∑–¥–∞—Ç—å —Ü–µ–ª—å",
                highlight: ".feature-card:has(.feature-icon:contains('üéØ'))",
                actionUrl: "/goals/create"
            },
            {
                title: "–ü–æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –∫–æ–º–ø–∞–Ω—å–æ–Ω–æ–º üêæ",
                content: "–í–∞—à –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥—Ä—É–≥ –±—É–¥–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –≤–∞—à–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –ø–æ–º–æ–≥–∞—Ç—å –≤ —Ç—Ä—É–¥–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã.",
                action: "–í—Å—Ç—Ä–µ—Ç–∏—Ç—å –∫–æ–º–ø–∞–Ω—å–æ–Ω–∞",
                highlight: ".feature-card:has(.feature-icon:contains('üêæ'))",
                actionFunction: "openCompanionDialog"
            }
        ];

        function startOnboarding() {
            currentOnboardingStep = 0;
            showOnboardingModal();
        }

        function showOnboardingModal() {
                const step = onboardingSteps[currentOnboardingStep];
                const modal = document.createElement('div');
                modal.className = 'onboarding-modal';

                // safe progress calculation
                const totalSteps = onboardingSteps.length;
                const displayStep = totalSteps > 0 ? Math.min(currentOnboardingStep + 1, totalSteps) : 0;
                const progressPercent = totalSteps > 0 ? Math.round((displayStep / totalSteps) * 100) : 0;

                modal.innerHTML = `
                    <div class="onboarding-dialog">
                        <div class="onboarding-header">
                            <h3>${step.title}</h3>
                            <button class="onboarding-close" onclick="closeOnboarding()">&times;</button>
                        </div>
                        <div class="onboarding-body">
                            <p>${step.content}</p>
                            <div class="onboarding-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${Math.max(0, Math.min(100, progressPercent))}%"></div>
                                </div>
                                <span class="progress-text">${displayStep} –∏–∑ ${totalSteps}</span>
                            </div>
                        </div>
                        <div class="onboarding-footer">
                            <button class="btn btn-secondary" onclick="closeOnboarding()">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
                            <button class="btn btn-primary" onclick="nextOnboardingStep()">${step.action}</button>
                        </div>
                    </div>
                `;

            document.body.appendChild(modal);

            // Highlight element if specified
            if (step.highlight) {
                setTimeout(() => {
                    const element = document.querySelector(step.highlight);
                    if (element) {
                        element.classList.add('onboarding-highlight');
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 300);
            }
        }

        function nextOnboardingStep() {
            const step = onboardingSteps[currentOnboardingStep];

            // Perform action based on step
            if (step.actionUrl) {
                window.location.href = step.actionUrl;
                return;
            } else if (step.actionFunction) {
                window[step.actionFunction]();
            }

            // Remove previous highlight
            document.querySelectorAll('.onboarding-highlight').forEach(el => el.classList.remove('onboarding-highlight'));

            currentOnboardingStep++;

            if (currentOnboardingStep >= onboardingSteps.length) {
                completeOnboarding();
                return;
            }

            // Close current modal and show next
            document.querySelector('.onboarding-modal').remove();
            showOnboardingModal();
        }

        function closeOnboarding() {
            document.querySelectorAll('.onboarding-modal').forEach(modal => modal.remove());
            document.querySelectorAll('.onboarding-highlight').forEach(el => el.classList.remove('onboarding-highlight'));
        }

        function completeOnboarding() {
            closeOnboarding();
            // Mark as completed in session
            fetch('/api/onboarding/complete', { method: 'POST' })
                .then(() => {
                    // Hide welcome message
                    const welcome = document.querySelector('.onboarding-welcome');
                    if (welcome) welcome.style.display = 'none';
                    // Show celebration
                    if (window.sofiaCompanion) {
                        window.sofiaCompanion.celebrate();
                        setTimeout(() => {
                            window.sofiaCompanion.showMessage("–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ! üöÄ");
                        }, 1000);
                    }
                })
                .catch(() => {
                    const welcome = document.querySelector('.onboarding-welcome');
                    if (welcome) welcome.style.display = 'none';
                    if (window.sofiaCompanion) {
                        window.sofiaCompanion.celebrate();
                        setTimeout(() => {
                            window.sofiaCompanion.showMessage("–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ! üöÄ");
                        }, 1000);
                    }
                });
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Add companion interactions to buttons
            const buttons = document.querySelectorAll('.btn');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    // Random companion reaction based on button type
                    if (this.classList.contains('btn-primary')) {
                        if (Math.random() < 0.3) { // 30% chance
                            celebrateCompanion();
                        }
                    } else if (this.textContent.includes('–∑–∞–º–µ—Ç–∫') || this.textContent.includes('–∑–∞–ø–∏—Å')) {
                        if (Math.random() < 0.4) { // 40% chance
                            remindCompanion();
                        }
                    } else if (this.textContent.includes('—Ü–µ–ª') || this.textContent.includes('–¥–æ—Å—Ç–∏–∂–µ–Ω–∏')) {
                        if (Math.random() < 0.3) { // 30% chance
                            encourageCompanion();
                        }
                    } else if (this.textContent.includes('–∫–æ–º–ø–∞–Ω—å–æ–Ω')) {
                        openCompanionDialog();
                    }
                });
            });

            // Special interaction for feature cards
            const featureCards = document.querySelectorAll('.feature-card');
            featureCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    if (Math.random() < 0.1) { // 10% chance
                        if (window.sofiaCompanion) {
                            const messages = [
                                "–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã–π! üåü",
                                "–ü–æ–ø—Ä–æ–±—É–π —ç—Ç–æ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª! üí´",
                                "–û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä! üëç"
                            ];
                            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                            window.sofiaCompanion.showMessage(randomMessage);
                        }
                    }
                });
            });
        });
    </script>
}

<style>
.hero-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 0 0 20px 20px;
}

.stat-card {
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 10px;
    backdrop-filter: blur(10px);
}

.stat-number {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 5px;
}

.stat-label {
    font-size: 0.9rem;
    opacity: 0.9;
}

.feature-card {
    background: white;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    height: 100%;
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
}

.feature-icon {
    font-size: 3rem;
    margin-bottom: 20px;
}

.feature-card h4 {
    color: #333;
    margin-bottom: 15px;
}

.feature-card p {
    color: #666;
    margin-bottom: 20px;
}

.step-item {
    display: flex;
    align-items: flex-start;
    gap: 15px;
    padding: 20px 0;
}

.step-number {
    background: #667eea;
    color: white;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    flex-shrink: 0;
}

.step-content h5 {
    color: #333;
    margin-bottom: 10px;
}

.step-content p {
    color: #666;
    margin-bottom: 15px;
}

.tips-list, .benefits-list {
    list-style: none;
    padding: 0;
}

.tips-list li, .benefits-list li {
    padding: 10px 0;
    border-bottom: 1px solid #f0f0f0;
    font-size: 14px;
}

.tips-list li:last-child, .benefits-list li:last-child {
    border-bottom: none;
}

.card {
    transition: transform 0.2s ease;
}

.card:hover {
    transform: translateY(-2px);
}

@@media (max-width: 768px) {
    .hero-section {
        padding: 30px 0;
    }
    
    .display-4 {
        font-size: 2.5rem;
    }
    
    .feature-card {
        padding: 20px;
    }
    
    .step-item {
        flex-direction: column;
        text-align: center;
    }
}
</style>
